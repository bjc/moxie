(defpackage clhs-lookup
  (:use :common-lisp)
  (:export :symbol-lookup
           :populate-table
           :spec-lookup))
(in-package :clhs-lookup)

(defparameter *hyperspec-pathname* (translate-logical-pathname "MOXIE:RES;"))

(defparameter *hyperspec-map-file* (merge-pathnames "Map_Sym.txt" *hyperspec-pathname*))

(defparameter *hyperspec-root* "http://www.lispworks.com/reference/HyperSpec/")

;;; AMOP.
(defparameter *mop-map-file* (merge-pathnames "Mop_Sym.txt" *hyperspec-pathname*))

(defparameter *mop-root* "http://www.alu.org/mop/")

(defvar *symbol-table* (make-hash-table :test 'equal))

(defvar *section-table* (make-hash-table :test 'equal))

(defvar *format-table* (make-hash-table :test 'equal))

(defvar *populated-p* nil)
                                                   
(defun add-clhs-section-to-table (&rest numbers)
  (let ((key (format nil "濑蕻" numbers))
        (target (concatenate 'string *hyperspec-root* (format nil "Body/2,'0d_(扯蟒┊梏恝ㄣ狎铛礅弪螬磲疸狎＇灬礅溽ǐ供ㄣ潋铛礅弪螬┅┅箦翩ㄧ弭栳箬脲箦泗轱瞽翎忪濯翎蜱弭┅ㄤ彐躅鲠扉洵翎蜱弭é蝈篝铛礅弪螬痱镡瀛骈戾ㄦ矧磲铋⒙镤铂О溥扯蟒┊梏恝ㄣ狎铛礅弪螬磲疸狎＇灬礅溽ǐ供ㄣ潋铛礅弪螬┅┅ㄤ彐鲠灬篝麽蝾糸礤癌ㄤ彐躅痫瘐灬翦翎忪ī躅戾篌痫瘐灬翦洵皙换腮疱蝮疱鏖翳镳孱骈戾棂疱蝮疱悱磲瓠骈戾洪姝滹弩铒舡屮轶铋飑换痫瘐灬翦翳翎忪鏖翳翳簌礅镬骝镯翳歪骈戾换翳轶忾轶遽簌犷痫螋徕戾躅戾篌麒孱ōㄧ弭躅轹弪筢飙糸礤灬篝麽蝾糸礤卑ㄦ矧磲趄徙瀛秕麴豸⒆狎铋铉泔蹯铒骈钿棂疱蝮疱磲骈戾龄牾篝翳疳翳狒翳麸镦沆梵祜镫躔扉箴麸珏扉铍麸翳腮疱蛴疱惝ア箦翩灬篝麽蝾糸礤ㄧ弭躅轹弪筢飙糸礤┅蝈趱蝾骝镯痫瘐灬翦翎忪铋飑ㄤè簌礅镬钺礤蝈徜扉铄铋螬蝈徜扉铄铋螬躜蝈徜扉铄铋螬蝈徜扉铄铋螬┅è羼躜螬т镱濠箦翩ㄧ弭栳箬簌礅镬钺礤簌礅镬翎忪濯ㄣ镱汜翦钺翦篝蜷铉棂疱蝮疱悱蝻雉篚怏羼躜畅┅换徜轭箦泗轱蝈驽蝈钽弩戾è溴驷蹯舡疳翳钺礤溴驷蹯趔棂疱蝮疱悱疳翳钺礤┅换脔氘腩秣崎弩麇煦镯瀹祜镳骘箦泗轱骝镯麸卜滹ㄡ滗沆梵箦泗轱瞽麸翎忪箦泗轱瞟滹祜镳钺礤骘蟊骝镯麸捕躅戾篌鲠扉洵翎蜱弭箦泗轱蟊滹蝈趱蝾骝镯铋飑滹ㄡ滗沆梵箦泗轱瞽麸翎忪箦泗轱蟊滹祜镳钺礤篌骘蟛骝镯麸捕躅戾篌鲠扉洵翎蜱弭箦泗轱蟊蟛滹蝈趱蝾骝镯篌铋飑滹ㄡ滗沆梵箦泗轱瞽麸翎忪箦泗轱蟊蟛滹祜镳钺礤篌骘蟪骝镯麸捕躅戾篌鲠扉洵翎蜱弭箦泗轱蟊蟛蟪滹蝈趱蝾骝镯篌铋飑滹ㄡ滗沆梵箦泗轱瞽麸翎忪箦泗轱蟊蟛蟪滹祜镳钺礤篌篌骘蟠骝镯麸捕躅戾篌鲠扉洵翎蜱弭箦泗轱蟊蟛蟪蟠滹蝈趱蝾骝镯篌篌铋飑滹ㄡ滗沆梵箦泗轱瞽麸翎忪箦泗轱蟊蟛蟪蟠滹祜镳钺礤篌篌骘蟮骝镯麸捕躅戾篌鲠扉洵翎蜱弭箦泗轱蟊蟛蟪蟠蟮滹蝈趱蝾骝镯篌篌铋飑滹ㄡ滗沆梵箦泗轱瞽麸翎忪箦泗轱蟊蟛蟪蟠蟮┅┅┅┅换骘蝽狒溟蝈泗轹弩祜镳骘泔溴骝镯巢麸辈滹箦翩ㄧ弭栳箬ㄦ矧磲铋立ㄣ镤瀛汨狎泔溴┅骘蝽狒翎忪濯ㄣ镱汜翦钺翦篝蜷铉棂疱蝮疱悱蝻雉ㄣ狍ㄣ镤瀛汨狎泔溴è＼＼茅⒙镤膊咩後梏恝è＼ォ⒙镤膊咩徕梏恝è＼Ι⒙镤膊咩徙梏恝è＼⒙镤膊咩徜梏恝è＼⒙镤膊咩徨梏恝è＼＼药⒙镤膊咩忉梏恝è＼＼末⒙镤膊咩忖梏恝è＼＼漏⒙镤膊咩忏梏恝è＼＼烯⒙镤膊咩怃梏恝è＼＼丞⒙镤膊咩忮梏恝è＼＼譬⒙镤膊咩汜梏恝è＼＼农⒙镤膊咩汊梏恝è＼＼签⒙镤膊咩沣梏恝è＼ぉ⒙镤膊咩沅梏恝è＼＼俩⒙镤膊咩溽梏恝è＼＼萤⒙镤膊咩溻梏恝è＼＼砖⒙镤膊咩溷梏恝è＼擤⒙镤膊咩遽梏恝花ǎ芗⒙镤膊咩邂梏恝è＼＼嫂⒙镤膊咩邈梏恝è＼⒙镤膊咩邃梏恝è＼＼冤⒙镤膊咩驷梏恝换粕赝è＼缉⒙镤膊咩驸梏恝è＼京⒙镤膊咩驺梏恝è＼⒙镤膊咩玑梏恝è＼郓⒙镤膊咩玮梏恝è＼荸⒙镤膊咩玢梏恝è＼⒙镤膊咩玟梏恝è＼⒙镤膊咩珏梏恝è＼咯⒙镤膊咩珂梏恝è＼ī⒙镤膊咩栳梏恝è＼┅⒙镤膊咩桠梏恝è＼＼些⒙镤膊咩桡梏恝è＼哗⒙镤膊咩獒梏恝è＼蕞⒙镤膊咩殁梏恝è＼五黛轭濠⒙镤膊咩殂梏恝⒙镤膊咩梏恝┅┅换珈矬筢蝙换拖鏖翳镳孱骈戾盹瓠磲瓠骈戾洪姝滹弩铒舡屮轶铋飑麒孱ㄤè簌礅镬钺礤蝈徜扉铄铋螬蝈徜扉铄铋螬躜蝈徜扉铄铋螬蝈徜扉铄铋螬┅è羼躜螬т镱濠箦翩ㄧ弭栳箬ㄣ镱汜翦钺翦篝蜷铉⑼闲孩簌礅镬钺礤簌礅镬翎忪濯ㄣ镱汜翦钺翦篝蜷铉盹瓠蝻雉躜飑┅┅箦翩痫瘐灬翦洵皙舂┅ㄤ彐躅箴邈祜镫躔翦蝽脲豉疱横祆┅躅戾篌痫瘐灬翦洵皙痫瘐灬翦翎忪濠ㄥ汜箦豉疱ê犰矧ㄧ弭栳箬翦蝽簌礅镬翎忪濯ㄧ弭栳箬翦蝽箦泗轱瞽翎忪濯ㄧ弭栳箬翦蝽骘蝽狒翎忪濯┅ê簌礅镬ㄧ弭栳箬翦蝽簌礅镬翎忪濯┅ê箦泗轱ㄧ弭栳箬翦蝽箦泗轱瞽翎忪濯┅ê骘蝽狒ㄧ弭栳箬翦蝽骘蝽狒翎忪濯┅┅ㄤ彐躅簌礅镬祜镫躔翦蝽箴邈祜镫躔翦蝽呼疱后礅镬┅